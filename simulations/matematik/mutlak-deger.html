<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raporlab Pro - Mutlak Değer</title>
    <style>
        :root {
            /* RAPORLAB PRO TEMA (v7.0 - Absolute) */
            --bg-app: #f8fafc;      
            --bg-panel: #ffffff;    
            --text-main: #0f172a;
            --text-muted: #64748b;
            
            --color-main: #ef4444;  /* Ana Değer (Kırmızı) */
            --color-ref: #3b82f6;   /* Referans Noktası (Mavi) */
            --color-dist: #10b981;  /* Mesafe (Yeşil) */
            
            --border: #e2e8f0;
            --radius: 16px;
            --font: 'Segoe UI', 'Inter', sans-serif;
            --font-mono: 'Consolas', monospace;
        }

        body { 
            margin: 0; padding: 0; 
            background: var(--bg-app); 
            color: var(--text-main); 
            font-family: var(--font); 
            height: 100vh; 
            display: flex; 
            overflow: hidden; 
        }

        /* --- SOL PANEL --- */
        aside { 
            width: 360px; flex-shrink: 0;
            background: var(--bg-panel); 
            border-right: 1px solid var(--border); 
            padding: 25px; 
            display: flex; flex-direction: column; gap: 20px; 
            z-index: 20; box-shadow: 5px 0 30px rgba(0,0,0,0.05);
        }

        .logo { font-size: 1.5rem; display: flex; align-items: baseline; gap: 6px; user-select: none; }
        .logo .brand-bold { font-weight: 800; color: var(--color-main); letter-spacing: -0.5px; }
        .logo .brand-thin { font-weight: 300; color: var(--text-muted); }

        /* Denklem Kartı */
        .math-card {
            background: #1e293b; color: white;
            padding: 25px; border-radius: var(--radius);
            text-align: center;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .equation { font-family: var(--font-mono); font-size: 2rem; font-weight: bold; margin-bottom: 5px; }
        .eq-label { font-size: 0.85rem; color: #94a3b8; }
        .val-res { color: var(--color-dist); }

        /* Mod Seçici */
        .mode-switch { display: flex; background: #f1f5f9; padding: 4px; border-radius: 12px; }
        .mode-btn { 
            flex: 1; border: none; background: transparent; color: var(--text-muted); 
            padding: 10px; cursor: pointer; font-weight: 600; border-radius: 8px; transition: 0.2s;
        }
        .mode-btn.active { background: white; color: var(--text-main); box-shadow: 0 2px 5px rgba(0,0,0,0.05); }

        /* Kontroller */
        .params { background: white; padding: 20px; border-radius: var(--radius); border: 2px solid var(--border); }
        .slider-row { display: flex; align-items: center; gap: 10px; margin-bottom: 15px; }
        
        input[type="range"] { 
            flex: 1; -webkit-appearance: none; background: #e2e8f0; height: 8px; border-radius: 4px; outline: none; 
        }
        input[type="range"]::-webkit-slider-thumb { 
            -webkit-appearance: none; width: 22px; height: 22px; 
            background: white; border: 4px solid var(--color-main); border-radius: 50%; 
            cursor: pointer; transition: transform 0.2s; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        input[type="range"]::-webkit-slider-thumb:hover { transform: scale(1.15); }
        
        /* İkinci slider için renk değişimi */
        #slA::-webkit-slider-thumb { border-color: var(--color-ref); }

        .info-panel { 
            margin-top: auto; background: #ecfdf5; 
            border-left: 4px solid var(--color-dist); 
            padding: 15px; border-radius: 12px; 
            font-size: 0.85rem; line-height: 1.5; color: #065f46;
        }

        /* --- CANVAS --- */
        main { 
            flex: 1; position: relative; 
            background: var(--bg-app);
            /* Grid */
            background-image: linear-gradient(#e2e8f0 1px, transparent 1px), linear-gradient(90deg, #e2e8f0 1px, transparent 1px);
            background-size: 40px 40px;
            display: flex; justify-content: center; align-items: center;
        }

        #simCanvas {
            border-radius: 20px;
            background: rgba(255,255,255,0.8);
            box-shadow: 0 20px 60px rgba(0,0,0,0.05);
            border: 1px solid white;
        }
    </style>
</head>
<body>

<aside>
    <div class="logo">
        <span class="brand-bold">Raporlab</span>
        <span class="brand-thin">İnteraktif</span>
    </div>

    <div class="mode-switch">
        <button class="mode-btn active" onclick="app.setMode(1)">Sıfıra Uzaklık (|x|)</button>
        <button class="mode-btn" onclick="app.setMode(2)">İki Nokta (|x-a|)</button>
    </div>

    <div class="math-card">
        <div class="equation" id="dispEq">|-5| = 5</div>
        <div class="eq-label" id="dispDesc">Sıfıra olan mesafe</div>
    </div>

    <div class="params">
        <div class="slider-row">
            <span style="font-weight:bold; color:var(--color-main); width:20px;">x</span>
            <input type="range" id="slX" min="-8" max="8" step="0.1" value="-5">
            <span id="valX" style="width:30px; text-align:right; font-family:monospace;">-5</span>
        </div>

        <div class="slider-row" id="rowA" style="display:none; opacity:0; transition:0.3s;">
            <span style="font-weight:bold; color:var(--color-ref); width:20px;">a</span>
            <input type="range" id="slA" min="-8" max="8" step="0.5" value="3">
            <span id="valA" style="width:30px; text-align:right; font-family:monospace;">3</span>
        </div>
    </div>

    <div class="info-panel">
        <b>Mutlak Değer:</b> Sayı doğrusu üzerindeki mesafe ölçerdir. <br>
        Yönü (işareti) önemsemez, sadece ne kadar adım attığını sayar.
    </div>
</aside>

<main>
    <canvas id="simCanvas"></canvas>
</main>

<script>
    const app = {
        canvas: document.getElementById('simCanvas'),
        ctx: null,
        width: 0, height: 0,
        
        state: {
            mode: 1, // 1: |x|, 2: |x-a|
            x: -5,
            a: 3,
            scale: 50, // 1 birim = 50px
            offsetX: 0, offsetY: 0
        },

        init: function() {
            this.ctx = this.canvas.getContext('2d');
            
            const slX = document.getElementById('slX');
            const slA = document.getElementById('slA');

            const update = () => {
                this.state.x = parseFloat(slX.value);
                this.state.a = parseFloat(slA.value);
                
                document.getElementById('valX').innerText = this.state.x;
                document.getElementById('valA').innerText = this.state.a;
                
                this.updateMath();
                this.draw();
            };

            slX.addEventListener('input', update);
            slA.addEventListener('input', update);

            window.addEventListener('resize', () => this.resize());
            this.resize();
            update();
        },

        resize: function() {
            const m = document.querySelector('main');
            this.width = this.canvas.width = m.clientWidth - 40;
            this.height = this.canvas.height = m.clientHeight - 40;
            this.state.offsetX = this.width / 2;
            this.state.offsetY = this.height / 2;
            this.draw();
        },

        setMode: function(m) {
            this.state.mode = m;
            document.querySelectorAll('.mode-btn').forEach((b, i) => {
                b.className = (i + 1 === m) ? 'mode-btn active' : 'mode-btn';
            });

            const rowA = document.getElementById('rowA');
            if(m === 2) {
                rowA.style.display = 'flex';
                setTimeout(() => rowA.style.opacity = 1, 10);
                document.getElementById('dispDesc').innerText = "İki nokta arası mesafe";
            } else {
                rowA.style.opacity = 0;
                setTimeout(() => rowA.style.display = 'none', 300);
                document.getElementById('dispDesc').innerText = "Sıfıra olan mesafe";
            }
            this.updateMath();
            this.draw();
        },

        updateMath: function() {
            const { mode, x, a } = this.state;
            let html = "";
            let res = 0;

            if (mode === 1) {
                res = Math.abs(x);
                html = `|${x}| = <span class="val-res">${res.toFixed(1)}</span>`;
            } else {
                res = Math.abs(x - a);
                // İşaret kontrolü (Parantez içi temiz görünsün)
                let inner = `${x} - ${a}`;
                if (a < 0) inner = `${x} - (${a})`;
                
                html = `|${inner}| = <span class="val-res">${res.toFixed(1)}</span>`;
            }
            // Ondalıklar .0 ise sil
            html = html.replace(/\.0/g, '');
            document.getElementById('dispEq').innerHTML = html;
        },

        draw: function() {
            const ctx = this.ctx;
            const { width, height } = this;
            const { x, a, mode, scale, offsetX, offsetY } = this.state;

            ctx.clearRect(0, 0, width, height);
            
            // Koordinat Sistemi
            const cy = offsetY;
            
            // 1. Sayı Doğrusu
            ctx.beginPath();
            ctx.strokeStyle = "#94a3b8"; ctx.lineWidth = 2;
            ctx.moveTo(0, cy); ctx.lineTo(width, cy);
            ctx.stroke();

            // Çentikler
            ctx.textAlign = "center"; ctx.font = "12px sans-serif"; ctx.fillStyle = "#64748b";
            
            const startTick = -Math.floor(offsetX / scale);
            const endTick = Math.ceil((width - offsetX) / scale);

            for(let i = startTick; i <= endTick; i++) {
                const px = offsetX + i * scale;
                
                ctx.beginPath();
                ctx.moveTo(px, cy - 5); ctx.lineTo(px, cy + 5);
                ctx.stroke();
                
                if (i === 0) {
                    ctx.font = "bold 14px sans-serif"; ctx.fillStyle = "#0f172a";
                    ctx.fillText(i, px, cy + 25);
                    ctx.font = "12px sans-serif"; ctx.fillStyle = "#64748b";
                } else {
                    ctx.fillText(i, px, cy + 20);
                }
            }

            // 2. Noktalar ve Mesafe
            const pxX = offsetX + x * scale;
            const pxA = mode === 2 ? offsetX + a * scale : offsetX; // Mod 1 ise referans 0'dır.

            // Mesafe Çizgisi (Lazer)
            const dist = Math.abs(x - (mode === 2 ? a : 0));
            const midY = cy - 60;

            if (dist > 0.05) {
                ctx.beginPath();
                ctx.strokeStyle = "var(--color-dist)"; ctx.lineWidth = 3;
                // Kesikli çizgi yerine düz ok daha iyi
                ctx.moveTo(Math.min(pxX, pxA), midY);
                ctx.lineTo(Math.max(pxX, pxA), midY);
                ctx.stroke();

                // Uç Sınırları
                ctx.beginPath();
                ctx.moveTo(pxX, midY - 5); ctx.lineTo(pxX, midY + 5);
                ctx.moveTo(pxA, midY - 5); ctx.lineTo(pxA, midY + 5);
                ctx.stroke();

                // İzdüşümler (Kesikli)
                ctx.setLineDash([4, 4]); ctx.lineWidth = 1; ctx.strokeStyle = "#cbd5e1";
                ctx.beginPath();
                ctx.moveTo(pxX, midY); ctx.lineTo(pxX, cy);
                ctx.moveTo(pxA, midY); ctx.lineTo(pxA, cy);
                ctx.stroke();
                ctx.setLineDash([]);

                // Mesafe Etiketi
                ctx.fillStyle = "white"; 
                ctx.beginPath(); 
                const midX = (pxX + pxA) / 2;
                // Hap şeklinde arkaplan
                ctx.roundRect(midX - 25, midY - 12, 50, 24, 12);
                ctx.fill(); ctx.lineWidth=1; ctx.strokeStyle="var(--color-dist)"; ctx.stroke();
                
                ctx.fillStyle = "var(--color-dist)"; ctx.font = "bold 14px sans-serif";
                ctx.fillText(dist.toFixed(1).replace('.0',''), midX, midY + 4);
            }

            // X Noktası (Oyuncu/Nesne)
            this.drawPin(pxX, cy, "x", "var(--color-main)");

            // A Noktası (Referans) - Sadece Mod 2'de veya Mod 1'de 0 ise
            if (mode === 2) {
                this.drawPin(pxA, cy, "a", "var(--color-ref)");
            } else {
                // Mod 1'de Sıfır noktası zaten belirgin ama yine de vurgulayalım
                ctx.beginPath(); ctx.arc(offsetX, cy, 4, 0, Math.PI*2); ctx.fillStyle="#0f172a"; ctx.fill();
            }
        },

        drawPin: function(x, y, label, color) {
            const ctx = this.ctx;
            
            // Pin Şekli
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineTo(x - 10, y - 25);
            ctx.quadraticCurveTo(x, y - 40, x + 10, y - 25);
            ctx.closePath();
            
            ctx.fillStyle = color; ctx.fill();
            ctx.strokeStyle = "white"; ctx.lineWidth = 2; ctx.stroke();

            ctx.fillStyle = "white"; ctx.font = "bold 12px sans-serif";
            ctx.fillText(label, x, y - 20);
        }
    };

    app.init();
</script>
</body>
</html>
